<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„±ì  ë¶„ì„ ëŒ€ì‹œë³´ë“œ (Grade Analysis Dashboard)</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <div class="container">
            <h1>ì„±ì  ë¶„ì„ ë¦¬í¬íŠ¸</h1>
            <p>Grade Analysis Dashboard & Visualization</p>
        </div>
    </header>

    <main class="container">
        
        <!-- Key Metrics -->
        <section id="metrics">
            <h2 class="section-title">ğŸ“Š í•µì‹¬ ì§€í‘œ (Key Metrics)</h2>
            <div class="stats-grid" id="stats-container">
                <!-- Javascript will populate this -->
            </div>
        </section>

        <!-- Visualizations -->
        <section id="visualizations">
            <h2 class="section-title">ğŸ“ˆ ë°ì´í„° ì‹œê°í™” (Data Visualization)</h2>
            <div class="gallery-grid">
                <div class="image-card">
                    <img src="06_grade_histogram.png" alt="ì´ì  ë¶„í¬ íˆìŠ¤í† ê·¸ë¨">
                    <div class="caption">ì´ì  ë¶„í¬ (Score Distribution)</div>
                </div>
                <div class="image-card">
                    <img src="06_mid_vs_final.png" alt="ì¤‘ê°„/ê¸°ë§ ìƒê´€ê´€ê³„">
                    <div class="caption">ì¤‘ê°„ vs ê¸°ë§ (Mid/Final Correlation)</div>
                </div>
                <div class="image-card">
                    <img src="06_score_boxplot.png" alt="í•­ëª©ë³„ ì ìˆ˜ ë¶„í¬">
                    <div class="caption">í•­ëª©ë³„ ì ìˆ˜ ë¶„í¬ (Boxplot)</div>
                </div>
            </div>
        </section>

        <!-- Top Students -->
        <section id="top-students">
            <h2 class="section-title">ğŸ† ì„±ì  ìš°ìˆ˜ì (Top Performer)</h2>
            <div class="table-container">
                <table id="top-students-table">
                    <thead>
                        <tr>
                            <th>ìˆœìœ„ (Rank)</th>
                            <th>ì´ë¦„ (Name)</th>
                            <th>ì´ì  (Total Score)</th>
                            <th>ë“±ê¸‰ (Grade)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Javascript will populate this -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Full Data Table (Foldable or Scrollable) -->
        <section id="full-data">
            <h2 class="section-title">ğŸ“‹ ì „ì²´ ë°ì´í„° (Full Dataset)</h2>
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table id="full-data-table">
                    <thead>
                        <tr>
                            <th>ì´ë¦„</th>
                            <th>ì¤‘ê°„ (30%)</th>
                            <th>ê¸°ë§ (30%)</th>
                            <th>ìˆ˜í–‰1 (20%)</th>
                            <th>ìˆ˜í–‰2 (20%)</th>
                            <th>ì´ì </th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Javascript will populate this -->
                    </tbody>
                </table>
            </div>
        </section>

    </main>

    <script>
        // Raw CSV Data Injection
        const csvData = `ì´ë¦„,ì¤‘ê°„ê³ ì‚¬(30%),ê¸°ë§ê³ ì‚¬(30%),ìˆ˜í–‰í‰ê°€1(20%),ìˆ˜í–‰í‰ê°€2(20%),ì´ì 
í•™ìƒ1,99,81,78,76,84.8
í•™ìƒ2,53,53,77,74,62.0
í•™ìƒ3,99,92,94,92,94.5
í•™ìƒ4,54,91,77,95,77.9
í•™ìƒ5,64,92,88,94,83.2
í•™ìƒ6,40,42,85,77,57.0
í•™ìƒ7,63,83,89,64,74.4
í•™ìƒ8,54,100,66,62,71.8
í•™ìƒ9,61,61,95,74,70.4
í•™ìƒ10,64,41,97,71,65.1
í•™ìƒ11,72,93,90,82,83.9
í•™ìƒ12,73,57,80,61,67.2
í•™ìƒ13,43,55,61,70,55.6
í•™ìƒ14,91,73,92,84,84.4
í•™ìƒ15,57,69,79,69,67.4
í•™ìƒ16,61,78,62,82,70.5
í•™ìƒ17,74,78,93,68,77.8
í•™ìƒ18,84,94,97,100,92.8
í•™ìƒ19,71,89,97,88,85.0
í•™ìƒ20,54,83,67,98,74.1
í•™ìƒ21,70,70,100,85,79.0
í•™ìƒ22,94,80,91,85,87.4
í•™ìƒ23,45,72,76,84,67.1
í•™ìƒ24,82,46,80,91,72.6
í•™ìƒ25,77,43,90,100,74.0
í•™ìƒ26,68,40,67,74,60.6
í•™ìƒ27,86,91,78,67,82.1
í•™ìƒ28,70,51,79,74,66.9
í•™ìƒ29,67,80,70,89,75.9
í•™ìƒ30,51,92,92,95,80.3`;

        // Parse CSV
        function parseCSV(csv) {
            const lines = csv.trim().split('\\n');
            const headers = lines[0].split(',');
            // Mapping headers to simpler keys
            const keyMap = {
                'ì´ë¦„': 'name',
                'ì¤‘ê°„ê³ ì‚¬(30%)': 'midterm',
                'ê¸°ë§ê³ ì‚¬(30%)': 'final',
                'ìˆ˜í–‰í‰ê°€1(20%)': 'perf1',
                'ìˆ˜í–‰í‰ê°€2(20%)': 'perf2',
                'ì´ì ': 'total'
            };
            
            return lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                headers.forEach((header, index) => {
                    const key = keyMap[header.trim()] || header.trim();
                    const value = values[index].trim();
                    // Convert to number if it looks like one
                    obj[key] = isNaN(value) ? value : parseFloat(value);
                });
                return obj;
            });
        }

        const data = parseCSV(csvData);

        // 1. Calculate Stats
        const totalMean = (data.reduce((sum, row) => sum + row.total, 0) / data.length).toFixed(1);
        const midMean = (data.reduce((sum, row) => sum + row.midterm, 0) / data.length).toFixed(1);
        const finalMean = (data.reduce((sum, row) => sum + row.final, 0) / data.length).toFixed(1);
        const studentCount = data.length;

        // Render Stats
        const statsContainer = document.getElementById('stats-container');
        const stats = [
            { label: 'ì „ì²´ í•™ìƒ ìˆ˜', value: studentCount + 'ëª…' },
            { label: 'ì´ì  í‰ê· ', value: totalMean + 'ì ' },
            { label: 'ì¤‘ê°„ê³ ì‚¬ í‰ê· ', value: midMean + 'ì ' },
            { label: 'ê¸°ë§ê³ ì‚¬ í‰ê· ', value: finalMean + 'ì ' }
        ];

        stats.forEach(stat => {
            const el = document.createElement('div');
            el.className = 'stat-card';
            el.innerHTML = `<h3>${stat.label}</h3><div class="value">${stat.value}</div>`;
            statsContainer.appendChild(el);
        });

        // 2. Render Top 5 Students
        const top5 = [...data].sort((a, b) => b.total - a.total).slice(0, 5);
        const topTableBody = document.querySelector('#top-students-table tbody');
        
        top5.forEach((student, index) => {
            const tr = document.createElement('tr');
            let grade = 'A';
            if (student.total < 90) grade = 'B';
            if (student.total < 80) grade = 'C'; 
            if (student.total < 70) grade = 'D';
            
            tr.innerHTML = `
                <td><span class="rank-badge">${index + 1}</span></td>
                <td><b>${student.name}</b></td>
                <td>${student.total}</td>
                <td>${grade}</td>
            `;
            topTableBody.appendChild(tr);
        });

        // 3. Render Full Table
        const fullTableBody = document.querySelector('#full-data-table tbody');
        data.forEach(student => {
             const tr = document.createElement('tr');
             tr.innerHTML = `
                <td>${student.name}</td>
                <td>${student.midterm}</td>
                <td>${student.final}</td>
                <td>${student.perf1}</td>
                <td>${student.perf2}</td>
                <td><b>${student.total}</b></td>
             `;
             fullTableBody.appendChild(tr);
        });

    </script>
</body>
</html>
